# Event-Driven Architecture Tutorial

[source,bash]
----
#!/bin/bash
minishift profile set eda-tutorial
minishift config set memory 8GB
minishift config set cpus 3
minishift config set vm-driver virtualbox ## or kvm, for Fedora
minishift config set image-caching true
minishift config set openshift-version v3.11.0
minishift addon enable admin-user
minishift addon enable anyuid

minishift start
minishift ssh -- sudo setenforce 0
----

[#environment]
== Setup environment

[source,bash]
----
eval $(minishift oc-env)
eval $(minishift docker-env)
oc login $(minishift ip):8443 -u admin -p admin
----

[#environment]
== Deploying Strimzi
[source,bash]
----
curl -L https://github.com/strimzi/strimzi-kafka-operator/releases/download/0.10.0/strimzi-0.10.0.tar.gz | tar xzf -
----

[source,bash]
----
sed -i '' 's/namespace: .*/namespace: strimzi-infra/' install/cluster-operator/*RoleBinding*.yaml
----

[source,bash]
----
oc new-project strimzi-infra
oc apply -f install/cluster-operator -n strimzi-infra
oc apply -f examples/templates/cluster-operator -n strimzi-infra
oc apply -f examples/kafka/kafka-persistent-single.yaml
----

[#mysql]
== Deploy a MySQL database instance

[source,bash]
----
oc new-app https://github.com/yanaga/eda-tutorial.git --strategy=docker --name=mysql --context-dir=docker-images/mysql \
-e MYSQL_ROOT_PASSWORD=redhat \
-e MYSQL_USER=mysqluser \
-e MYSQL_PASSWORD=mysqlpw
----

