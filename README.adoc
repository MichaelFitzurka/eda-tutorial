# Event-Driven Architecture Tutorial

[source,bash]
----
#!/bin/bash
minishift profile set eda-tutorial
minishift config set memory 8GB
minishift config set cpus 3
minishift config set vm-driver virtualbox ## or kvm, for Fedora
minishift config set image-caching true
minishift config set openshift-version v3.11.0
minishift addon enable admin-user
minishift addon enable anyuid

minishift start
minishift ssh -- sudo setenforce 0
----

[#environment]
== Setup environment

[source,bash]
----
eval $(minishift oc-env)
eval $(minishift docker-env)
oc login $(minishift ip):8443 -u admin -p admin
----

[#mysql]
== Deploy a MySQL database instance

[source,bash]
----
oc new-app https://github.com/yanaga/eda-tutorial.git --strategy=docker --name=mysql --context-dir=docker-images/mysql \
-e MYSQL_ROOT_PASSWORD=redhat \
-e MYSQL_USER=mysqluser \
-e MYSQL_PASSWORD=mysqlpw
----

[#kafka-topic]
== Create a Kafka Topic

[source,bash]
----
oc process -n strimzi-infra kafka-topic-template WORKSHOP_USER=1 | oc apply -n strimzi-infra -f -
----

----
oc exec -it my-cluster-kafka-0 -c kafka -n strimzi-infra -- bin/kafka-topics.sh --zookeeper localhost:2181 --describe
----

== Port forward Kafka to your machine

[source,bash]
----
oc port-forward my-cluster-kafka-0 -n strimzi-infra 9092
----
